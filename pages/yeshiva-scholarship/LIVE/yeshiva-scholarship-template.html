<!--
====================================================================
ONE-TIME SETUP: Paste this template into Chabad One CMS
====================================================================
This template provides modern styling for the Yeshiva Scholarship page.
All styles are inline for maximum compatibility with Chabad One CMS.
====================================================================
-->

<div class="yeshiva-scholarship-wrapper">

<!-- Hero Section with Image -->
<div class="hero-section">
  <div class="hero-content">
    <img src="/media/images/1149/PnvY11494603.png" alt="Scholarship Grant" class="hero-image" />
    <div class="hero-text">
      <h1>Yeshiva Scholarship</h1>
      <p class="hero-subtitle">Connecting Young Adults with Their Jewish Heritage</p>
    </div>
  </div>
</div>

<!-- Main Content -->
<div class="content-section">

  <!-- Introduction -->
  <div class="text-block">
    <p>Before there were universities, there were yeshivas. There were people who sat around in yeshivas the whole year, discussing and studying and discussing some more. And then there were people who worked the farm or traveled afar to sell their merchandise, and then turned up at the yeshiva whenever they had a chance, to join in the study and discussion. Jews were always a literate society, and every Jew was expected to be involved somehow in the learning going on in the community.</p>
  </div>

  <div class="text-block">
    <p>Traditionally, most of the study in yeshiva was in pairs‚Äîtwo companions poring over a text together, debating its details to achieve clarity and full knowledge. A lecture is generally full of lively give-and-take between students and teacher. Traditional Jewish learning is all about asking good questions, as well as collaborating with others to come up with solutions.</p>
  </div>

  <div class="text-block">
    <p>That's why a yeshiva, unlike a college library, is a rather noisy place. In many ways, the methodology of study in yeshiva is way ahead of that applied in most educational institutions.</p>
  </div>

  <div class="text-block">
    <p>Today, there are all sorts of yeshivas. Some specialize exclusively in Talmud. Others diversify, studying practical Jewish law, history, ethics, Kabbalah and chassidic thought, etc. There are yeshivas dedicated to young men and women who just want to take off a semester to enrich their Jewish souls, and then get back home and finish their degree.</p>
  </div>

  <div class="text-block">
    <p>Chabad has a number of such yeshivas, and that's the general thrust in these places‚Äîto give students a strong background, skills to build upon and the inspiration they need for a lifetime‚Äîand then get them back on track into their careers. Only that now, the bright lights of their Jewish soul are shining.</p>
  </div>

  <!-- Highlighted Scholarship Info -->
  <div class="scholarship-highlight">
    <p><strong>The JRCC Jewish Discovery Scholarship offers financial assistance to help young men and women from the FSU find out more about and connect with their Jewish roots, with a choice of several educational institutions in Israel, New York and New Jersey.</strong></p>
  </div>

  <!-- Application Section -->
  <div class="application-section">
    <h2>To Apply</h2>

    <div class="application-options">

      <!-- Online Application Card -->
      <div class="application-card">
        <div class="card-icon">üìù</div>
        <h3>Apply Online</h3>
        <p>Fill out the scholarship form online for the fastest processing.</p>
        <a href="/Article.asp?AID=889639" class="apply-button">Fill Out Online Form</a>
      </div>

      <!-- Print & Submit Card -->
      <div class="application-card">
        <div class="card-icon">üñ®Ô∏è</div>
        <h3>Print & Submit</h3>
        <p>Download, print, and submit the application form by fax or in person.</p>
        <a href="/media/pdf/177/JVwL1775490.pdf" class="apply-button secondary">Download PDF Form</a>
        <div class="submit-details">
          <p><strong>Fax to:</strong> 416.222.7812</p>
          <p><strong>Deliver to:</strong> 5987 Bathurst St. Unit 3</p>
        </div>
      </div>

    </div>
  </div>

  <!-- Contact Section -->
  <div class="contact-section">
    <h2>Need More Information?</h2>
    <div class="contact-details">
      <div class="contact-item">
        <span class="contact-icon">üìû</span>
        <a href="tel:416.222.7105">416.222.7105</a>
      </div>
      <div class="contact-item">
        <span class="contact-icon">‚úâÔ∏è</span>
        <a href="mailto:chesed@jrcc.org">chesed@jrcc.org</a>
      </div>
    </div>
  </div>

</div>

</div>

<!-- Inline Styles -->
<style>
@import url('https://fonts.googleapis.com/css2?family=Urbanist:wght@300;400;500;600;700;800&display=swap');

/* Remove default background images and spacing */
body,
body.cco_body {
    background-image: none !important;
    background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 50%, #f0f7fb 100%) !important;
}

#BodyContainer,
#co_content_container,
.body_wrapper,
#content {
    background-image: none !important;
    background: transparent !important;
    padding-top: 0 !important;
    padding-bottom: 0 !important;
    margin-top: 0 !important;
    margin-bottom: 0 !important;
}

.master-content-wrapper,
.master-content-wrapper.g960,
div.master-content-wrapper,
div.master-content-wrapper.g960 {
    background-image: none !important;
    background: transparent !important;
    background-color: transparent !important;
    padding: 0 !important;
    margin: 0 !important;
    min-height: 0 !important;
}

/* Main Wrapper */
.yeshiva-scholarship-wrapper {
    max-width: 1200px !important;
    margin: 0 auto !important;
    padding: 0 !important;
    font-family: 'Urbanist', sans-serif !important;
}

/* Make CMS synopsis content visible - keep original small size */
body .article_index_container .co_index.article_index .row .item .synopsis,
body div.article_index_container div.co_index.article_index div.row div.item div.synopsis,
html body .article_index_container .co_index.article_index .row .item .synopsis,
.article_index_container .co_index.article_index .row .item .synopsis,
.article_index_container .co_index .row .item .synopsis,
.co_index .row .item .synopsis,
#co_content_container .synopsis,
.synopsis,
div.synopsis {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
    height: auto !important;
    max-height: none !important;
    overflow: visible !important;
    white-space: normal !important;
    text-overflow: clip !important;
}

/* Make the title link always visible - overlaid on image */
body .article_index_container .co_index.article_index .row .item .title a,
.article_index_container .co_index.article_index .row .item .title a,
.co_index.article_index .row .item .title a {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 20px !important;
    color: #fff !important;
    text-decoration: none !important;
    opacity: 1 !important;
    visibility: visible !important;
    background: rgba(0, 0, 0, 0.4) !important;
    transition: all 0.3s !important;
    font-family: 'Urbanist', sans-serif !important;
    font-size: 18px !important;
    font-weight: 700 !important;
    text-align: center !important;
}

/* Show the parent title container */
body .article_index_container .co_index.article_index .row .item .title,
.article_index_container .co_index.article_index .row .item .title,
.co_index.article_index .row .item .title {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
}

/* Hero Section */
.hero-section {
    background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%) !important;
    padding: 4rem 3rem !important;
    margin-bottom: 3rem !important;
    border-radius: 0 0 32px 32px !important;
    box-shadow: 0 12px 40px rgba(30, 58, 138, 0.2) !important;
}

.hero-content {
    display: flex !important;
    align-items: center !important;
    gap: 3rem !important;
    max-width: 1000px !important;
    margin: 0 auto !important;
}

.hero-image {
    width: 200px !important;
    height: auto !important;
    border-radius: 16px !important;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3) !important;
    background: #ffffff !important;
    padding: 1rem !important;
}

.hero-text h1 {
    font-family: 'Urbanist', sans-serif !important;
    font-size: 4rem !important;
    font-weight: 800 !important;
    color: #ffffff !important;
    margin: 0 0 0.5rem 0 !important;
    letter-spacing: -1px !important;
}

.hero-subtitle {
    font-family: 'Urbanist', sans-serif !important;
    font-size: 1.5rem !important;
    font-weight: 400 !important;
    color: rgba(255, 255, 255, 0.9) !important;
    margin: 0 !important;
}

/* Content Section */
.content-section {
    padding: 0 3rem 4rem 3rem !important;
}

/* Text Blocks */
.text-block {
    margin-bottom: 1.5rem !important;
}

.text-block p {
    font-family: 'Urbanist', sans-serif !important;
    font-size: 1.375rem !important;
    line-height: 1.8 !important;
    color: #333333 !important;
    margin: 0 !important;
}

/* Scholarship Highlight Box */
.scholarship-highlight {
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%) !important;
    border-left: 6px solid #d4af37 !important;
    padding: 2rem 2.5rem !important;
    margin: 3rem 0 !important;
    border-radius: 16px !important;
    box-shadow: 0 8px 24px rgba(212, 175, 55, 0.2) !important;
}

.scholarship-highlight p {
    font-family: 'Urbanist', sans-serif !important;
    font-size: 1.5rem !important;
    line-height: 1.8 !important;
    color: #1f2937 !important;
    margin: 0 !important;
}

/* Application Section */
.application-section {
    margin: 4rem 0 !important;
}

.application-section h2 {
    font-family: 'Urbanist', sans-serif !important;
    font-size: 2.5rem !important;
    font-weight: 700 !important;
    color: #000000 !important;
    text-align: center !important;
    margin: 0 0 2.5rem 0 !important;
}

.application-options {
    display: grid !important;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)) !important;
    gap: 2rem !important;
}

/* Application Cards */
.application-card {
    background: #ffffff !important;
    border-radius: 24px !important;
    padding: 2.5rem !important;
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.1) !important;
    text-align: center !important;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
    border: 2px solid transparent !important;
}

.application-card:hover {
    transform: translateY(-8px) !important;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15) !important;
    border-color: #d4af37 !important;
}

.card-icon {
    font-size: 4rem !important;
    margin-bottom: 1.5rem !important;
}

.application-card h3 {
    font-family: 'Urbanist', sans-serif !important;
    font-size: 1.875rem !important;
    font-weight: 700 !important;
    color: #000000 !important;
    margin: 0 0 1rem 0 !important;
}

.application-card p {
    font-family: 'Urbanist', sans-serif !important;
    font-size: 1.125rem !important;
    line-height: 1.6 !important;
    color: #666666 !important;
    margin: 0 0 2rem 0 !important;
}

/* Apply Buttons */
.apply-button {
    display: inline-block !important;
    font-family: 'Urbanist', sans-serif !important;
    font-size: 1.125rem !important;
    font-weight: 700 !important;
    color: #ffffff !important;
    background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%) !important;
    padding: 1rem 2rem !important;
    border-radius: 12px !important;
    text-decoration: none !important;
    transition: all 0.3s ease !important;
    box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3) !important;
    border: none !important;
}

.apply-button:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 8px 20px rgba(30, 58, 138, 0.4) !important;
}

.apply-button.secondary {
    background: linear-gradient(135deg, #475569 0%, #64748b 100%) !important;
    box-shadow: 0 4px 12px rgba(71, 85, 105, 0.3) !important;
}

.apply-button.secondary:hover {
    box-shadow: 0 8px 20px rgba(71, 85, 105, 0.4) !important;
}

/* Submit Details */
.submit-details {
    margin-top: 2rem !important;
    padding-top: 2rem !important;
    border-top: 2px solid #f3f4f6 !important;
}

.submit-details p {
    font-family: 'Urbanist', sans-serif !important;
    font-size: 1.125rem !important;
    color: #4b5563 !important;
    margin: 0.5rem 0 !important;
}

.submit-details strong {
    color: #000000 !important;
    font-weight: 600 !important;
}

/* Contact Section */
.contact-section {
    background: linear-gradient(135deg, #f8f9fa 0%, #e8f4f8 100%) !important;
    padding: 3rem !important;
    border-radius: 24px !important;
    text-align: center !important;
    margin-top: 4rem !important;
}

.contact-section h2 {
    font-family: 'Urbanist', sans-serif !important;
    font-size: 2.25rem !important;
    font-weight: 700 !important;
    color: #000000 !important;
    margin: 0 0 2rem 0 !important;
}

.contact-details {
    display: flex !important;
    justify-content: center !important;
    gap: 3rem !important;
    flex-wrap: wrap !important;
}

.contact-item {
    display: flex !important;
    align-items: center !important;
    gap: 0.75rem !important;
}

.contact-icon {
    font-size: 1.5rem !important;
}

.contact-item a {
    font-family: 'Urbanist', sans-serif !important;
    font-size: 1.25rem !important;
    font-weight: 600 !important;
    color: #1e3a8a !important;
    text-decoration: none !important;
    transition: all 0.3s ease !important;
}

.contact-item a:hover {
    color: #d4af37 !important;
    transform: translateX(4px) !important;
}

/* ========================================
   MODERN GLASSMORPHISM SIDEBAR - DESKTOP
   ======================================== */
.g260,
div.g260,
.cco_search_header,
div[class*="g260"] {
    position: fixed !important;
    right: 0 !important;
    top: 50% !important;
    transform: translateY(-50%) translateX(calc(100% - 60px)) !important;

    /* Glassmorphism effect */
    background: rgba(255, 255, 255, 0.85) !important;
    backdrop-filter: blur(20px) saturate(180%) !important;
    -webkit-backdrop-filter: blur(20px) saturate(180%) !important;

    /* Premium borders and shadows */
    border-radius: 24px 0 0 24px !important;
    border: 1px solid rgba(255, 255, 255, 0.3) !important;
    border-right: none !important;
    box-shadow:
        -8px 0 32px rgba(0, 0, 0, 0.12),
        -2px 0 8px rgba(0, 0, 0, 0.06),
        inset 0 0 0 1px rgba(255, 255, 255, 0.5) !important;

    /* Sizing and spacing */
    padding: 2rem 1.5rem 2rem 2rem !important;
    margin: 0 !important;
    width: 320px !important;
    max-height: 85vh !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;

    /* Spring animation */
    transition: all 0.7s cubic-bezier(0.34, 1.56, 0.64, 1) !important;

    /* Layer */
    z-index: 1000 !important;
}

/* Hover to expand with smooth spring effect */
.g260:hover,
div.g260:hover,
.cco_search_header:hover {
    transform: translateY(-50%) translateX(0) !important;
    background: rgba(255, 255, 255, 0.95) !important;
    box-shadow:
        -12px 0 48px rgba(0, 0, 0, 0.18),
        -4px 0 12px rgba(0, 0, 0, 0.08),
        inset 0 0 0 1px rgba(255, 255, 255, 0.6) !important;
}

/* Tab indicator - modern minimal design */
.g260::before,
div.g260::before,
.cco_search_header::before {
    content: '' !important;
    position: absolute !important;
    left: 16px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    width: 24px !important;
    height: 4px !important;
    background: linear-gradient(90deg,
        rgba(30, 58, 138, 0.6),
        rgba(59, 130, 246, 0.8)) !important;
    border-radius: 2px !important;
    box-shadow: 0 2px 8px rgba(30, 58, 138, 0.3) !important;
    transition: all 0.7s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
    pointer-events: none !important;
}

/* Indicator rotates and changes on hover */
.g260:hover::before,
div.g260:hover::before,
.cco_search_header:hover::before {
    transform: translateY(-50%) rotate(90deg) !important;
    width: 4px !important;
    height: 24px !important;
    background: linear-gradient(180deg,
        rgba(30, 58, 138, 0.8),
        rgba(59, 130, 246, 1)) !important;
}

/* Custom scrollbar for sidebar */
.g260::-webkit-scrollbar,
div.g260::-webkit-scrollbar,
.cco_search_header::-webkit-scrollbar {
    width: 6px !important;
}

.g260::-webkit-scrollbar-track,
div.g260::-webkit-scrollbar-track,
.cco_search_header::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.05) !important;
    border-radius: 3px !important;
}

.g260::-webkit-scrollbar-thumb,
div.g260::-webkit-scrollbar-thumb,
.cco_search_header::-webkit-scrollbar-thumb {
    background: rgba(30, 58, 138, 0.3) !important;
    border-radius: 3px !important;
}

.g260::-webkit-scrollbar-thumb:hover,
div.g260::-webkit-scrollbar-thumb:hover,
.cco_search_header::-webkit-scrollbar-thumb:hover {
    background: rgba(30, 58, 138, 0.5) !important;
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .hero-section {
        padding: 2rem 1.5rem !important;
        border-radius: 0 0 24px 24px !important;
    }

    .hero-content {
        flex-direction: column !important;
        text-align: center !important;
        gap: 2rem !important;
    }

    .hero-image {
        width: 150px !important;
    }

    .hero-text h1 {
        font-size: 2.5rem !important;
    }

    .hero-subtitle {
        font-size: 1.125rem !important;
    }

    .content-section {
        padding: 0 1.5rem 3rem 1.5rem !important;
    }

    .text-block p {
        font-size: 1.125rem !important;
    }

    .scholarship-highlight {
        padding: 1.5rem !important;
    }

    .scholarship-highlight p {
        font-size: 1.25rem !important;
    }

    .application-section h2 {
        font-size: 2rem !important;
    }

    .application-options {
        grid-template-columns: 1fr !important;
    }

    .application-card {
        padding: 2rem !important;
    }

    .contact-section {
        padding: 2rem 1.5rem !important;
    }

    .contact-section h2 {
        font-size: 1.875rem !important;
    }

    .contact-details {
        flex-direction: column !important;
        gap: 1.5rem !important;
    }

    /* ========================================
       MOBILE BOTTOM SHEET SIDEBAR
       ======================================== */
    /* Hide original sidebar on mobile - we create a custom one via JavaScript */
    .g260,
    div.g260,
    .cco_search_header {
        display: none !important;
    }
}

/* Responsive adjustments for smaller phones */
@media (max-width: 480px) {
    .hero-title {
        font-size: 2rem !important;
    }

    .hero-subtitle {
        font-size: 1rem !important;
    }
}

/* Responsive adjustments for larger phones and tablets */
@media (min-width: 481px) and (max-width: 768px) {
    .hero-title {
        font-size: 2.5rem !important;
    }
}
</style>

<script>
//<![CDATA[
(function() {
    // Only run on mobile
    if (window.innerWidth > 768) {
        return;
    }

    var initialized = false;
    var backdrop = null;
    var isOpen = false;

    function findSidebar() {
        // Try all possible selectors
        var selectors = [
            '.g260',
            'div.g260',
            '.cco_search_header',
            '[class*="g260"]',
            'aside',
            '[class*="sidebar"]',
            '[class*="search"]'
        ];

        for (var i = 0; i < selectors.length; i++) {
            var el = document.querySelector(selectors[i]);
            if (el) {
                // Check if it looks like a sidebar (positioned fixed or absolute)
                var style = window.getComputedStyle(el);
                if (style.position === 'fixed' || style.position === 'absolute') {
                    return el;
                }
            }
        }
        return null;
    }

    function initMobileSidebar() {
        if (initialized) return;

        var originalSidebar = findSidebar();
        if (!originalSidebar) {
            console.log('Sidebar not found yet...');
            return;
        }

        // Check if sidebar has REAL content (navigation links, not just search form)
        // The search form loads first (87 chars), navigation links load later
        var sidebarContent = originalSidebar.textContent || originalSidebar.innerText || '';
        var contentLength = sidebarContent.trim().length;

        // Look for navigation elements specifically
        var hasNavigation = originalSidebar.querySelector('.co_local_menu, .sidebar-local-navigation, nav, ul li a') !== null;
        var hasMultipleChildren = originalSidebar.children.length > 1;
        var hasSubstantialContent = contentLength > 200; // Navigation links will make it much longer than 87 chars

        if (!hasNavigation && !hasMultipleChildren && !hasSubstantialContent) {
            console.log('Sidebar found but only has search form (', contentLength, 'chars), waiting for navigation...');
            return;
        }

        initialized = true;
        console.log('Mobile sidebar initialized!', originalSidebar);
        console.log('Sidebar has', originalSidebar.children.length, 'child elements');
        console.log('Sidebar content length:', sidebarContent.length);

        // HIDE the original sidebar completely on mobile - we'll create our own
        originalSidebar.style.setProperty('display', 'none', 'important');

        // Calculate responsive height based on screen size
        var viewportHeight = window.innerHeight;
        var sidebarHeight = viewportHeight <= 667 ? '85vh' : '80vh'; // iPhone SE and smaller get more height
        var visibleTab = viewportHeight <= 667 ? '50px' : '60px'; // Smaller tab on small screens

        // Create a BRAND NEW mobile sidebar container with full control
        var mobileSidebar = document.createElement('div');
        mobileSidebar.className = 'mobile-sidebar-custom';
        mobileSidebar.style.cssText = `
            position: fixed !important;
            bottom: 0 !important;
            left: 0 !important;
            right: 0 !important;
            width: 100% !important;
            height: ${sidebarHeight} !important;
            max-height: ${sidebarHeight} !important;
            background: rgba(255, 255, 255, 0.98) !important;
            backdrop-filter: blur(20px) saturate(180%) !important;
            -webkit-backdrop-filter: blur(20px) saturate(180%) !important;
            border-radius: 28px 28px 0 0 !important;
            box-shadow: 0 -8px 32px rgba(0, 0, 0, 0.2) !important;
            transform: translateY(calc(100% - ${visibleTab})) !important;
            transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
            z-index: 100001 !important;
            overflow-y: auto !important;
            padding: 20px !important;
            padding-top: 60px !important;
        `.replace(/\s+/g, ' ').trim();

        // Add iOS-style handle pill
        var handle = document.createElement('div');
        handle.style.cssText = `
            position: absolute !important;
            top: 16px !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            width: 48px !important;
            height: 5px !important;
            background: rgba(30, 58, 138, 0.3) !important;
            border-radius: 3px !important;
            pointer-events: none !important;
        `.replace(/\s+/g, ' ').trim();
        mobileSidebar.appendChild(handle);

        // Clone the content from original sidebar
        var contentWrapper = document.createElement('div');
        contentWrapper.className = 'mobile-sidebar-content';
        contentWrapper.style.cssText = `
            width: 100% !important;
            overflow-x: hidden !important;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        `.replace(/\s+/g, ' ').trim();

        // Deep clone to preserve all elements and event listeners
        var clonedContent = originalSidebar.cloneNode(true);

        // Remove the display:none we added
        clonedContent.style.display = 'block';
        clonedContent.style.visibility = 'visible';
        clonedContent.style.opacity = '1';

        // Transfer all content
        while (clonedContent.firstChild) {
            contentWrapper.appendChild(clonedContent.firstChild);
        }

        // Force all child elements to be visible
        var allElements = contentWrapper.getElementsByTagName('*');
        for (var i = 0; i < allElements.length; i++) {
            var el = allElements[i];
            // Don't force scripts or hidden inputs to be visible
            if (el.tagName !== 'SCRIPT' && el.tagName !== 'STYLE' && el.type !== 'hidden') {
                el.style.display = el.style.display === 'none' ? 'block' : el.style.display;
                el.style.visibility = 'visible';
                el.style.opacity = el.style.opacity === '0' ? '1' : el.style.opacity;
            }
        }

        mobileSidebar.appendChild(contentWrapper);

        console.log('Sidebar content cloned. Content HTML:', contentWrapper.innerHTML.substring(0, 500));
        console.log('Content has children:', contentWrapper.children.length);

        document.body.appendChild(mobileSidebar);

        // Create backdrop
        backdrop = document.createElement('div');
        backdrop.style.cssText = `
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            bottom: 0 !important;
            background: rgba(0,0,0,0.5) !important;
            opacity: 0 !important;
            visibility: hidden !important;
            z-index: 100000 !important;
            transition: all 0.3s ease !important;
            pointer-events: none !important;
        `.replace(/\s+/g, ' ').trim();
        document.body.appendChild(backdrop);

        var touchStartY = 0;
        var touchStartTime = 0;

        function open() {
            isOpen = true;
            mobileSidebar.style.transform = 'translateY(0) !important';
            mobileSidebar.style.setProperty('transform', 'translateY(0)', 'important');

            if (backdrop) {
                backdrop.style.opacity = '1';
                backdrop.style.visibility = 'visible';
                backdrop.style.pointerEvents = 'auto';
            }

            console.log('Mobile sidebar opened!');
        }

        function close() {
            isOpen = false;
            mobileSidebar.style.setProperty('transform', 'translateY(calc(100% - ' + visibleTab + '))', 'important');

            if (backdrop) {
                backdrop.style.opacity = '0';
                backdrop.style.visibility = 'hidden';
                backdrop.style.pointerEvents = 'none';
            }

            console.log('Mobile sidebar closed');
        }

        // Touch handling for opening the sidebar
        function handleSidebarTouch(e) {
            // Only handle touches on the visible tab area (bottom 60px) when closed
            if (!isOpen) {
                var rect = mobileSidebar.getBoundingClientRect();
                var touchY = e.touches[0].clientY;
                // Check if touch is in the visible tab area
                if (touchY >= rect.top && touchY <= window.innerHeight) {
                    touchStartY = touchY;
                    touchStartTime = Date.now();
                }
            }
        }

        function handleSidebarTouchEnd(e) {
            if (!isOpen) {
                var touchEndY = e.changedTouches[0].clientY;
                var touchEndTime = Date.now();
                var verticalDiff = Math.abs(touchEndY - touchStartY);
                var timeDiff = touchEndTime - touchStartTime;

                // Tap to open (minimal movement, quick duration)
                if (verticalDiff < 20 && timeDiff < 400) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Sidebar tab tapped!');
                    open();
                    return false;
                }
                // Swipe up to open
                else if (touchEndY < touchStartY - 30 && timeDiff < 500) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Swipe up detected!');
                    open();
                    return false;
                }
            }
        }

        // Attach events to mobileSidebar
        mobileSidebar.addEventListener('touchstart', handleSidebarTouch, { passive: true });
        mobileSidebar.addEventListener('touchend', handleSidebarTouchEnd, false);

        // Also handle clicks for desktop testing
        mobileSidebar.addEventListener('click', function(e) {
            if (!isOpen) {
                var rect = mobileSidebar.getBoundingClientRect();
                var clickY = e.clientY;
                // Only open if clicking in visible tab area
                if (clickY >= rect.top) {
                    e.preventDefault();
                    console.log('Sidebar tab clicked!');
                    open();
                }
            }
        }, false);

        // Backdrop events to close
        if (backdrop) {
            backdrop.addEventListener('touchend', function(e) {
                e.preventDefault();
                e.stopPropagation();
                close();
            }, false);

            backdrop.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                close();
            }, false);
        }

        // Keyboard
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && isOpen) {
                close();
            }
        });

        console.log('Mobile sidebar events attached');
    }

    // Use MutationObserver to watch for sidebar being added
    var observer = new MutationObserver(function(mutations) {
        if (!initialized) {
            initMobileSidebar();
        }
    });

    observer.observe(document.documentElement, {
        childList: true,
        subtree: true
    });

    // Also try the traditional methods
    initMobileSidebar();

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initMobileSidebar);
    }

    window.addEventListener('load', initMobileSidebar);

    // Try initialization multiple times with increasing delays
    // The CMS loads search form first (~87 chars), then navigation links dynamically
    // We need to wait for the full navigation content to load
    setTimeout(initMobileSidebar, 100);
    setTimeout(initMobileSidebar, 300);
    setTimeout(initMobileSidebar, 500);
    setTimeout(initMobileSidebar, 800);
    setTimeout(initMobileSidebar, 1000);
    setTimeout(initMobileSidebar, 1500);
    setTimeout(initMobileSidebar, 2000);
    setTimeout(initMobileSidebar, 2500);
    setTimeout(initMobileSidebar, 3000);
    setTimeout(initMobileSidebar, 4000);
    setTimeout(initMobileSidebar, 5000);
    setTimeout(initMobileSidebar, 6000);
    setTimeout(initMobileSidebar, 7000);
    setTimeout(initMobileSidebar, 8000);
    setTimeout(initMobileSidebar, 10000);
})();
//]]>
</script>
